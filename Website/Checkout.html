<html>
	<head>
		<title>GMIT-Games</title>
		<!-- Drop Down Styling -->
		<link rel="stylesheet"	type="text/css" href="Scripts/Dropdown.css"/>
		
		<!-- Header -->
		<link rel="stylesheet"	type="text/css" href="Scripts/Header.css"/>
		
		<!-- Bootstrap CSS -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
		
		<!-- Checkout CSS -->
		<link rel="stylesheet"	type="text/css" href="Scripts/Checkout.css"/>
	</head>
	<body>
<!-- Start of Header Menu (C.McGr)-->
<div class="navbar navbar-expand-lg navbar-light .bg-light" id="Header">
	<img src="Images/Logo.png" class="responsive">
	<div class="container-fluid">
					<a class="text-dark navbar-brand" href="Home.html">Home</a>
					
					<!-- Something to do with short browser width and it turns the bar into a drop down. -->
					<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>

				<div class="collapse navbar-collapse" id="navbarNav">
				<!-- Navigation bar -->
					<ul class="navbar-nav me-auto mb-2 mb-lg-0">
					
					<!-- Drop Down -->
					<div class="dropdown">
						<button class="dropbtn" id="buttonDropDownMenu">Browse</button>
						<div class="dropdown-content">
							<a href="GenreGames/Action.html">Action</a>
							<a href="GenreGames/Adventure.html">Adventure</a>
							<a href="GenreGames/MMO.html">MMO Games</a>
							<a href="GenreGames/Racing.html">Racing</a>
							<a href="GenreGames/Strategy.html">Strategy</a>
						</div>
					</div>
					
						<!-- Whats on sale -->
						<li class="navbar-item">
							<a class="nav-link text-dark navbar-brand" href="WhatsOnSale.html">What's On Sale</a>
						</li>
						
						<!-- Best Sellers -->
						<li class="navbar-item">
							<a class="nav-link text-dark navbar-brand" id="bestSellerItemMenu" href="BestSellers.html">Best Sellers</a>
						</li>
						
						<!-- User Panel -->
						<li class="navbar-item">
							<a class="nav-link text-dark navbar-brand" href="Login.html">User Panel</a>
						</li>
						
						<li class="navbar-item">
							<a href="Cart.html">
								<img src="Images/Cart.png" class="nav-link text-dark navbar-brand responsive" id="cart">
							</a>
						</li>
						
						<!-- DOM -->
						<li class="navbar-item" id="logout">
							
						</li>

					</ul>
					<div id="welcomeMessage"></div>
				</div>
	</div>
</div>
<!-- End of Header Menu -->
<!-- Checkout HTML and CSS taken from https://www.w3schools.com/howto/howto_css_checkout_form.asp and edited by (C.McGr)-->
<!-- start of Billing Address section -->
<div class="row"> <!-- Div class row container -->
  <div class="col-75"> <!-- Div class col-75 container-->
    <div class="container"><!-- Div class container-->
      <form action="Confirmed.html"> <!-- Redirect to confirmed.html after submitting -->
      <!-- this is the column which asks the user to input their fullname, address, Email and City -->
        <div class="row"> <!-- Div class row container -->
          <div class="col-50"> <!-- Div class col-50 container-->
            <h3>Billing Address</h3>
            <label for="fname"><i class="fa fa-user"></i> Full Name</label> <!-- label for full name-->
            <input type="text" id="fname" name="firstname" placeholder="John M. Doe" required> <!-- input type is text - placeholder is gray text and required means it must be entered-->
            <label for="email"><i class="fa fa-envelope"></i> Email</label> <!-- label for Email-->
            <input type="email" id="email" name="email" placeholder="john@example.com" required>
            <label for="adr"><i class="fa fa-address-card-o"></i> Address</label> <!-- label for Address-->
            <input type="text" id="adr" name="address" placeholder="542 W. 15th Street" required>
            <label for="city"><i class="fa fa-institution"></i> City</label> <!-- label for City-->
            <input type="text" id="city" name="city" placeholder="Dublin" required>
		<!-- this is the row which asks the user to input their county, Zip code, Exp Year, CVV -->
            <div class="row"> <!-- Div class row container -->
              <div class="col-50"> <!-- Div class col-50 container-->
                <label for="state">County</label> <!-- label for County-->
                <input type="text" id="state" name="state" placeholder="Galway" required>
              </div>
              <div class="col-50"> <!-- Div class col-50 container-->
                <label for="zip">Zip</label> <!-- label for Zip-->
                <input type="text" id="zip" name="zip" placeholder="H54 F394" maxlength="8" required> <!-- maxlength means the maximum characters that can be entered-->
              </div>
            </div>
          </div>
		<!-- this is the column which asks the user to input the name on the card, the number, the month and year it expires, and the CVV -->
          <div class="col-50"> <!-- Div class col-50 container-->
            <h3>Payment</h3>
            <img src="images/e.jpg" style="height: 104px;"> <!-- Image with css properties inline -->
            <label for="cname">Name on Card</label> <!-- label for Name on Card-->
            <input type="text" id="cname" name="cardname" placeholder="John More Doe" required>
            <label for="ccnum">Credit card number</label> <!-- label for Credit card number-->
            <input type="number" id="ccnum" name="cardnumber" placeholder="1111-2222-3333-4444" maxlength="16" pattern="[0-9\s]{13,19}" required> <!-- Pattern is meant to make it so only numericals can be typed but doesn't work -->
            <label for="expmonth">Exp Month</label> <!-- label for Exp Month-->
            <input type="text" id="expmonth" name="expmonth" placeholder="September" required>
            <div class="row"> 
              <div class="col-50">
                <label for="expyear">Exp Year</label> <!-- label for Exp Year-->
                <input type="tel" id="expyear" name="expyear" placeholder="2022" maxlength="4" required>
              </div>
              <div class="col-50">
                <label for="cvv">CVV</label>  <!-- label for CVV-->
                <input type="tel" id="cvv" name="cvv" placeholder="352" maxlength="3" required>
              </div>
            </div>
          </div>
          
        </div>
       <a href="Confirmation"><input type="submit" value="Pay" class="btn"> </a> <!-- Submit button for form -->
      </form>
    </div>
  </div>
  
  <div class="col-25"> <!-- Discount code -->
    <div class="container"><!-- Container class -->
      <h4>Cart <span class="price" style="color:black"><i class="fa fa-shopping-cart"></i></span></h4> <!-- styling using bootstrap and css -->
      <hr>
	  <h3 id="totalPrice">Total : €0.00</h3>
	  <input type="text" id="discountCode" placeholder="Discount Code"> <!-- input for coupon code -->
	  <button class="btn btn-primary" onclick="checkCoupon()">Apply Discount Code</button> <!-- Button for applying Coupon code -->
    </div>
  </div>
</div>
<!-- End of Billing Address section -->
<!-- Start of Java Script section -->
</body>
	<script>
	//(C.McGr)
		let totalValue = localStorage.getItem('totalValue'); //Get localstorage item and set it to variable totalValue 
		let totalPriceDOM = document.getElementById("totalPrice"); //Get element ID totalPrice and set it to variable totalPriceDOM 
		totalPriceDOM.innerHTML = "Total :  €" + totalValue;
		
		var couponCodes = ["gmit2020", "cian", "adrian", "jack"]; //Array of coupon codes
		let isCouponApplied = 0; // Var isCouponApplied = 0
		sessionStorage.setItem('CouponApplied', 'yy'); //Set sessionStorage 'CouponApplied' = 'yy'
		
		var dates = new Date();//Sets dates to a new date object
		let [date, month, year] = new Date().toLocaleDateString("en-IE").split("/"); //Sets variables date, month and year to current date in IE timezone
		let expireDate = "31"; let expireMonth = "6"; let expireYear = "2021"; //Sets Expirey date of the coupon codes.
		
		function checkCoupon() //function checkCoupon
		{
		if (date <= expireDate && month <= expireMonth && year <= expireYear) //Logic used to determine if the coupon is expired
		{
		let couponInput = document.getElementById("discountCode").value; // var couponInput = ID discountCode's value
		let inputLowerCase = couponInput.toLowerCase(); // sets couponInput to lowercase and stores it in inputLowerCase
		let couponValue = sessionStorage.getItem('CouponApplied'); //couponValue equals to CouponApplied session storage
		
		if (couponValue != 'xx') //if sessionStorage couponValue doesn't equal 'xx'
			{
			for(var i = 0; i < couponCodes.length; i++) //For loop to increase i if its less than array length
			{
			
				if (inputLowerCase == couponCodes[i]) //If the input thats a lowercase now is equal to the coupon code then isCouponApplied is set to 1
				{
					isCouponApplied = 1;
				}
			}
				if (isCouponApplied == 0) //If the input thats a lowercase now is not equal to the coupon code then isCouponApplied is set to 0
				{
					alert("Not a valid Coupon Code!");
				}
					
				if (isCouponApplied == 1) //If isCouponApplied is 1
				{
					alert("Coupon has been applied!"); //Alert
					totalValue = (totalValue*0.90); //apply price
					totalPriceDOM.innerHTML = "Total After Discount :  €" + Math.round(totalValue* 100)/ 100; //DOM the price into the webpage
					sessionStorage.setItem('CouponApplied', 'xx'); //Set sessionStorage Item
				}
			}

			if(couponValue == 'xx') //if sessionStorage couponValue does equal 'xx'
			{
				alert("Coupon already applied!"); //Alert
			}
		}
		else
			{
				alert("Coupon Is Expired!"); //Alert
			}
		}
	</script>
	<!-- end of Java Script section -->
</html>
